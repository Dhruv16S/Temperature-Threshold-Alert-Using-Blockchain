<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digiotai Solutions Private Limited</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../static/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
</head>
<body>

    <div class="split left">
        <h2>Temperature Threshold Alert Using Blockchain</h2>
        <p id="split-p">The following application accepts a datataset with temperature as an attribute. Based on the threshold set, a smart contract 
            is triggered to send an alert to the user. The smart contract is deployed on the Polygon network. Kindly ensure you have a MetaMask account.
        </p>

        {% if plot_line %}
            <img src="data:image/png;base64,{{ plot_line }}" alt="Line Plot">
        {% endif %}

        {% if plot_scatter %}
            <img src="data:image/png;base64,{{ plot_scatter }}" alt="Scatter Plot">
        {% endif %}
    </div>

    <div class="split right">
        <!-- Connect to account -->
        <div id="connect-account">
            <h2>Connect your MetaMask account</h2>
            <p id="split-p">Kindly ensure you have a MetaMask account. After that, click the button to connect</p>
            <button type="submit" id="connect">Connect</button>
            <p id="account" style="text-align:left"></p>
        </div>
        <!-- Deploy smart contract -->
        <div id="deploy-smart-contract" style="display: none;">
            <h2>Deploy the Smart Contract</h2>
            <p id="split-p">On clicking Submit, a Smart Contract will be deployed on the Polygon network. 
                A gas fee will be charged for the same.
            </p>
            <button type="submit" id="deploy">Deploy</button>
            <a href="" id="contract-url"><p id="contract-address" style="text-align:left"></p></a>
        </div>
        <!-- Choose Threshold -->
        <div id="enter-threshold" style="display: none;">
            <h2>Choose a Threshold temperature</h2>
            <p id="split-p">On clicking Submit, a Smart Contract will be triggered displaying all the dates and the time at which the
                temperature exceeded the threshold.
            </p>
            <input type="number" name="threshold" id="threshold" placeholder="Enter an integer value: ">
            <button type="submit" id="submit">Submit</button>
        </div>
    </div>

    <script>
        const dates = JSON.parse('{{ date_data | tojson }}');
        const times = JSON.parse('{{ time_data | tojson }}');
        const temperatures = JSON.parse('{{ temperature_data | tojson }}');
    </script>
    <script src="../static/script.js"></script>
    <script src="../static/credentials.js"></script>
    <script src="../static/smart_contracts_logic.js"></script>
</body>
</html>
